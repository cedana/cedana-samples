apiVersion: v1
kind: Pod
metadata:
  generateName: deepspeed-train-example-
  namespace: default
spec:
  runtimeClassName: cedana # required for GPU C/R support (use nvidia for native)
  containers:
    - name: deepspeed-train
      image: cedana/cedana-samples-test:cuda12.4-torch2.7@sha256:39bb73ec33c795351238bf9bea8f6135e515a1b4f9df60f71b2a557964aac72a
      command:
        - deepspeed
        - --num_gpus=1
        - gpu_smr/pytorch/training/deepspeed_train.py
      resources:
        limits:
          nvidia.com/gpu: 1
      env:
        - name: TORCH_EXTENSIONS_DIR
          value: /usr/local/share/torch_extensions # contains precompiled kernels 
